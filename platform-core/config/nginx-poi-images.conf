# =============================================================================
# Nginx Configuration for POI Images
# =============================================================================
# Serves locally stored POI images with optimal caching and performance.
#
# Add this to your nginx server block or include it:
#   include /var/www/api.holidaibutler.com/platform-core/config/nginx-poi-images.conf;
#
# Or copy the location block to your existing configuration.
# =============================================================================

# Serve POI images from local storage
location /poi-images/ {
    alias /var/www/api.holidaibutler.com/storage/poi-images/;

    # Cache for 30 days (images don't change)
    expires 30d;
    add_header Cache-Control "public, immutable";

    # Security headers
    add_header X-Content-Type-Options "nosniff";
    add_header X-Frame-Options "SAMEORIGIN";

    # Enable gzip for smaller files (though images are already compressed)
    gzip off;

    # CORS headers for frontend access
    add_header Access-Control-Allow-Origin "*";
    add_header Access-Control-Allow-Methods "GET, OPTIONS";

    # Disable directory listing
    autoindex off;

    # Handle missing files gracefully
    try_files $uri =404;

    # Optimize for static files
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;

    # Log access for monitoring (optional, can be disabled)
    access_log /var/log/nginx/poi-images.access.log;
}
